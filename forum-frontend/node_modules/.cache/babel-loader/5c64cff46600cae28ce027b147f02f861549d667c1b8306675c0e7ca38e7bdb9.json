{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useRef, useState, useCallback } from 'react';\nexport default function useWebSocket(url, options = {\n  manual: false\n}) {\n  _s();\n  const socketRef = useRef(null);\n  const [isConnected, setIsConnected] = useState(false);\n  const [messages, setMessages] = useState([]);\n  const [error, setError] = useState(null);\n  const [connectionStatus, setConnectionStatus] = useState('disconnected'); // new\n\n  const connect = useCallback(() => {\n    if (!url) {\n      console.error(\"WebSocket URL is required.\");\n      return;\n    }\n    if (socketRef.current && socketRef.current.readyState !== WebSocket.CLOSED) {\n      console.warn(\"WebSocket is already connected or connecting.\");\n      return;\n    }\n    socketRef.current = new WebSocket(url);\n    setConnectionStatus('connecting');\n    socketRef.current.onopen = () => {\n      console.log('WebSocket connection opened:', url);\n      setIsConnected(true);\n      setConnectionStatus('connected');\n    };\n    socketRef.current.onmessage = event => {\n      console.log('WebSocket message received:', event.data);\n      try {\n        const parsedData = JSON.parse(event.data);\n        setMessages(prev => [...prev, parsedData]);\n      } catch (err) {\n        console.error('Failed to parse WebSocket message', err);\n      }\n    };\n    socketRef.current.onerror = event => {\n      console.error('WebSocket error:', event, `URL: ${url}`);\n      setError('WebSocket encountered an error');\n      setConnectionStatus('error');\n    };\n    socketRef.current.onclose = event => {\n      console.warn('WebSocket closed:', event.code, event.reason);\n      setIsConnected(false);\n      setConnectionStatus('disconnected');\n    };\n  }, [url]);\n  const disconnect = useCallback(() => {\n    if (socketRef.current) {\n      socketRef.current.close();\n      socketRef.current = null;\n      setIsConnected(false);\n      setConnectionStatus('disconnected');\n    }\n  }, []);\n  const sendMessage = useCallback(message => {\n    if (socketRef.current && socketRef.current.readyState === WebSocket.OPEN) {\n      const messageStr = typeof message === 'string' ? message : JSON.stringify(message);\n      socketRef.current.send(messageStr);\n    } else {\n      var _socketRef$current;\n      console.error('WebSocket is not open. ReadyState:', (_socketRef$current = socketRef.current) === null || _socketRef$current === void 0 ? void 0 : _socketRef$current.readyState);\n    }\n  }, []);\n  useEffect(() => {\n    if (!options.manual) {\n      connect();\n    }\n    return () => {\n      disconnect();\n    };\n  }, [connect, disconnect, options.manual]);\n  return {\n    isConnected,\n    connectionStatus,\n    messages,\n    sendMessage,\n    error,\n    connect,\n    disconnect\n  };\n}\n_s(useWebSocket, \"A0fSAeQ0rJVXa982qgFoKfVtSQo=\");","map":{"version":3,"names":["useEffect","useRef","useState","useCallback","useWebSocket","url","options","manual","_s","socketRef","isConnected","setIsConnected","messages","setMessages","error","setError","connectionStatus","setConnectionStatus","connect","console","current","readyState","WebSocket","CLOSED","warn","onopen","log","onmessage","event","data","parsedData","JSON","parse","prev","err","onerror","onclose","code","reason","disconnect","close","sendMessage","message","OPEN","messageStr","stringify","send","_socketRef$current"],"sources":["/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/hooks/useWebSocket.js"],"sourcesContent":["import { useEffect, useRef, useState, useCallback } from 'react';\n\nexport default function useWebSocket(url, options = { manual: false }) {\n  const socketRef = useRef(null);\n  const [isConnected, setIsConnected] = useState(false);\n  const [messages, setMessages] = useState([]);\n  const [error, setError] = useState(null);\n  const [connectionStatus, setConnectionStatus] = useState('disconnected'); // new\n\n  const connect = useCallback(() => {\n    if (!url) {\n      console.error(\"WebSocket URL is required.\");\n      return;\n    }\n\n    if (socketRef.current && socketRef.current.readyState !== WebSocket.CLOSED) {\n      console.warn(\"WebSocket is already connected or connecting.\");\n      return;\n    }\n\n    socketRef.current = new WebSocket(url);\n    setConnectionStatus('connecting');\n\n    socketRef.current.onopen = () => {\n      console.log('WebSocket connection opened:', url);\n      setIsConnected(true);\n      setConnectionStatus('connected');\n    };\n\n    socketRef.current.onmessage = (event) => {\n      console.log('WebSocket message received:', event.data);\n      try {\n        const parsedData = JSON.parse(event.data);\n        setMessages((prev) => [...prev, parsedData]);\n      } catch (err) {\n        console.error('Failed to parse WebSocket message', err);\n      }\n    };\n\n    socketRef.current.onerror = (event) => {\n      console.error('WebSocket error:', event, `URL: ${url}`);\n      setError('WebSocket encountered an error');\n      setConnectionStatus('error');\n    };\n\n    socketRef.current.onclose = (event) => {\n      console.warn('WebSocket closed:', event.code, event.reason);\n      setIsConnected(false);\n      setConnectionStatus('disconnected');\n    };\n  }, [url]);\n\n  const disconnect = useCallback(() => {\n    if (socketRef.current) {\n      socketRef.current.close();\n      socketRef.current = null;\n      setIsConnected(false);\n      setConnectionStatus('disconnected');\n    }\n  }, []);\n\n  const sendMessage = useCallback((message) => {\n    if (socketRef.current && socketRef.current.readyState === WebSocket.OPEN) {\n      const messageStr = typeof message === 'string' ? message : JSON.stringify(message);\n      socketRef.current.send(messageStr);\n    } else {\n      console.error('WebSocket is not open. ReadyState:', socketRef.current?.readyState);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (!options.manual) {\n      connect();\n    }\n\n    return () => {\n      disconnect();\n    };\n  }, [connect, disconnect, options.manual]);\n\n  return { isConnected, connectionStatus, messages, sendMessage, error, connect, disconnect };\n}\n"],"mappings":";AAAA,SAASA,SAAS,EAAEC,MAAM,EAAEC,QAAQ,EAAEC,WAAW,QAAQ,OAAO;AAEhE,eAAe,SAASC,YAAYA,CAACC,GAAG,EAAEC,OAAO,GAAG;EAAEC,MAAM,EAAE;AAAM,CAAC,EAAE;EAAAC,EAAA;EACrE,MAAMC,SAAS,GAAGR,MAAM,CAAC,IAAI,CAAC;EAC9B,MAAM,CAACS,WAAW,EAAEC,cAAc,CAAC,GAAGT,QAAQ,CAAC,KAAK,CAAC;EACrD,MAAM,CAACU,QAAQ,EAAEC,WAAW,CAAC,GAAGX,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACY,KAAK,EAAEC,QAAQ,CAAC,GAAGb,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM,CAACc,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGf,QAAQ,CAAC,cAAc,CAAC,CAAC,CAAC;;EAE1E,MAAMgB,OAAO,GAAGf,WAAW,CAAC,MAAM;IAChC,IAAI,CAACE,GAAG,EAAE;MACRc,OAAO,CAACL,KAAK,CAAC,4BAA4B,CAAC;MAC3C;IACF;IAEA,IAAIL,SAAS,CAACW,OAAO,IAAIX,SAAS,CAACW,OAAO,CAACC,UAAU,KAAKC,SAAS,CAACC,MAAM,EAAE;MAC1EJ,OAAO,CAACK,IAAI,CAAC,+CAA+C,CAAC;MAC7D;IACF;IAEAf,SAAS,CAACW,OAAO,GAAG,IAAIE,SAAS,CAACjB,GAAG,CAAC;IACtCY,mBAAmB,CAAC,YAAY,CAAC;IAEjCR,SAAS,CAACW,OAAO,CAACK,MAAM,GAAG,MAAM;MAC/BN,OAAO,CAACO,GAAG,CAAC,8BAA8B,EAAErB,GAAG,CAAC;MAChDM,cAAc,CAAC,IAAI,CAAC;MACpBM,mBAAmB,CAAC,WAAW,CAAC;IAClC,CAAC;IAEDR,SAAS,CAACW,OAAO,CAACO,SAAS,GAAIC,KAAK,IAAK;MACvCT,OAAO,CAACO,GAAG,CAAC,6BAA6B,EAAEE,KAAK,CAACC,IAAI,CAAC;MACtD,IAAI;QACF,MAAMC,UAAU,GAAGC,IAAI,CAACC,KAAK,CAACJ,KAAK,CAACC,IAAI,CAAC;QACzChB,WAAW,CAAEoB,IAAI,IAAK,CAAC,GAAGA,IAAI,EAAEH,UAAU,CAAC,CAAC;MAC9C,CAAC,CAAC,OAAOI,GAAG,EAAE;QACZf,OAAO,CAACL,KAAK,CAAC,mCAAmC,EAAEoB,GAAG,CAAC;MACzD;IACF,CAAC;IAEDzB,SAAS,CAACW,OAAO,CAACe,OAAO,GAAIP,KAAK,IAAK;MACrCT,OAAO,CAACL,KAAK,CAAC,kBAAkB,EAAEc,KAAK,EAAE,QAAQvB,GAAG,EAAE,CAAC;MACvDU,QAAQ,CAAC,gCAAgC,CAAC;MAC1CE,mBAAmB,CAAC,OAAO,CAAC;IAC9B,CAAC;IAEDR,SAAS,CAACW,OAAO,CAACgB,OAAO,GAAIR,KAAK,IAAK;MACrCT,OAAO,CAACK,IAAI,CAAC,mBAAmB,EAAEI,KAAK,CAACS,IAAI,EAAET,KAAK,CAACU,MAAM,CAAC;MAC3D3B,cAAc,CAAC,KAAK,CAAC;MACrBM,mBAAmB,CAAC,cAAc,CAAC;IACrC,CAAC;EACH,CAAC,EAAE,CAACZ,GAAG,CAAC,CAAC;EAET,MAAMkC,UAAU,GAAGpC,WAAW,CAAC,MAAM;IACnC,IAAIM,SAAS,CAACW,OAAO,EAAE;MACrBX,SAAS,CAACW,OAAO,CAACoB,KAAK,CAAC,CAAC;MACzB/B,SAAS,CAACW,OAAO,GAAG,IAAI;MACxBT,cAAc,CAAC,KAAK,CAAC;MACrBM,mBAAmB,CAAC,cAAc,CAAC;IACrC;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMwB,WAAW,GAAGtC,WAAW,CAAEuC,OAAO,IAAK;IAC3C,IAAIjC,SAAS,CAACW,OAAO,IAAIX,SAAS,CAACW,OAAO,CAACC,UAAU,KAAKC,SAAS,CAACqB,IAAI,EAAE;MACxE,MAAMC,UAAU,GAAG,OAAOF,OAAO,KAAK,QAAQ,GAAGA,OAAO,GAAGX,IAAI,CAACc,SAAS,CAACH,OAAO,CAAC;MAClFjC,SAAS,CAACW,OAAO,CAAC0B,IAAI,CAACF,UAAU,CAAC;IACpC,CAAC,MAAM;MAAA,IAAAG,kBAAA;MACL5B,OAAO,CAACL,KAAK,CAAC,oCAAoC,GAAAiC,kBAAA,GAAEtC,SAAS,CAACW,OAAO,cAAA2B,kBAAA,uBAAjBA,kBAAA,CAAmB1B,UAAU,CAAC;IACpF;EACF,CAAC,EAAE,EAAE,CAAC;EAENrB,SAAS,CAAC,MAAM;IACd,IAAI,CAACM,OAAO,CAACC,MAAM,EAAE;MACnBW,OAAO,CAAC,CAAC;IACX;IAEA,OAAO,MAAM;MACXqB,UAAU,CAAC,CAAC;IACd,CAAC;EACH,CAAC,EAAE,CAACrB,OAAO,EAAEqB,UAAU,EAAEjC,OAAO,CAACC,MAAM,CAAC,CAAC;EAEzC,OAAO;IAAEG,WAAW;IAAEM,gBAAgB;IAAEJ,QAAQ;IAAE6B,WAAW;IAAE3B,KAAK;IAAEI,OAAO;IAAEqB;EAAW,CAAC;AAC7F;AAAC/B,EAAA,CA/EuBJ,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}