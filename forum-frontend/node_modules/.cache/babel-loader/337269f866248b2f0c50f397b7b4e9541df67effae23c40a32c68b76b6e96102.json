{"ast":null,"code":"var _s = $RefreshSig$();\n// src/hooks/useWebSocket.js\nimport { useState, useEffect } from 'react';\nconst useWebSocket = url => {\n  _s();\n  const [socket, setSocket] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [connectionStatus, setConnectionStatus] = useState('disconnected');\n  useEffect(() => {\n    let ws;\n    let reconnectTimeout;\n    const connect = () => {\n      ws = new WebSocket(url);\n      ws.onopen = () => {\n        console.log('WebSocket connected');\n        setSocket(ws);\n        setConnectionStatus('connected');\n      };\n      ws.onmessage = event => {\n        try {\n          const newMessage = JSON.parse(event.data);\n          setMessages(prev => [...prev, newMessage]);\n        } catch (err) {\n          console.error('Error parsing WebSocket message:', err);\n        }\n      };\n      ws.onclose = () => {\n        console.log('WebSocket disconnected');\n        setSocket(null);\n        setConnectionStatus('disconnected');\n        reconnectTimeout = setTimeout(() => {\n          setConnectionStatus('reconnecting');\n          connect();\n        }, 5000);\n      };\n      ws.onerror = error => {\n        console.error('WebSocket error:', error);\n        setConnectionStatus('error');\n      };\n    };\n    connect();\n    return () => {\n      if (ws && ws.readyState === WebSocket.OPEN) {\n        ws.close();\n      }\n      if (reconnectTimeout) {\n        clearTimeout(reconnectTimeout);\n      }\n    };\n  }, [url]);\n  const sendMessage = message => {\n    if (socket && socket.readyState === WebSocket.OPEN) {\n      socket.send(JSON.stringify(message));\n    } else {\n      console.error('WebSocket is not connected');\n    }\n  };\n  return {\n    socket,\n    messages,\n    sendMessage,\n    connectionStatus\n  };\n};\n_s(useWebSocket, \"IhKKRB2Nnw9qvmZutzwECZ0X7o4=\");\nexport default useWebSocket;","map":{"version":3,"names":["useState","useEffect","useWebSocket","url","_s","socket","setSocket","messages","setMessages","connectionStatus","setConnectionStatus","ws","reconnectTimeout","connect","WebSocket","onopen","console","log","onmessage","event","newMessage","JSON","parse","data","prev","err","error","onclose","setTimeout","onerror","readyState","OPEN","close","clearTimeout","sendMessage","message","send","stringify"],"sources":["/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/hooks/useWebSocket.js"],"sourcesContent":["// src/hooks/useWebSocket.js\nimport { useState, useEffect } from 'react';\n\nconst useWebSocket = (url) => {\n    const [socket, setSocket] = useState(null);\n    const [messages, setMessages] = useState([]);\n    const [connectionStatus, setConnectionStatus] = useState('disconnected');\n\n    useEffect(() => {\n        let ws;\n        let reconnectTimeout;\n\n        const connect = () => {\n            ws = new WebSocket(url);\n\n            ws.onopen = () => {\n                console.log('WebSocket connected');\n                setSocket(ws);\n                setConnectionStatus('connected');\n            };\n\n            ws.onmessage = (event) => {\n                try {\n                    const newMessage = JSON.parse(event.data);\n                    setMessages(prev => [...prev, newMessage]);\n                } catch (err) {\n                    console.error('Error parsing WebSocket message:', err);\n                }\n            };\n\n            ws.onclose = () => {\n                console.log('WebSocket disconnected');\n                setSocket(null);\n                setConnectionStatus('disconnected');\n                reconnectTimeout = setTimeout(() => {\n                    setConnectionStatus('reconnecting');\n                    connect();\n                }, 5000);\n            };\n\n            ws.onerror = (error) => {\n                console.error('WebSocket error:', error);\n                setConnectionStatus('error');\n            };\n        };\n\n        connect();\n\n        return () => {\n            if (ws && ws.readyState === WebSocket.OPEN) {\n                ws.close();\n            }\n            if (reconnectTimeout) {\n                clearTimeout(reconnectTimeout);\n            }\n        };\n    }, [url]);\n\n    const sendMessage = (message) => {\n        if (socket && socket.readyState === WebSocket.OPEN) {\n            socket.send(JSON.stringify(message));\n        } else {\n            console.error('WebSocket is not connected');\n        }\n    };\n\n    return {\n        socket,\n        messages,\n        sendMessage,\n        connectionStatus,\n    };\n};\n\nexport default useWebSocket;\n"],"mappings":";AAAA;AACA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAE3C,MAAMC,YAAY,GAAIC,GAAG,IAAK;EAAAC,EAAA;EAC1B,MAAM,CAACC,MAAM,EAAEC,SAAS,CAAC,GAAGN,QAAQ,CAAC,IAAI,CAAC;EAC1C,MAAM,CAACO,QAAQ,EAAEC,WAAW,CAAC,GAAGR,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACS,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGV,QAAQ,CAAC,cAAc,CAAC;EAExEC,SAAS,CAAC,MAAM;IACZ,IAAIU,EAAE;IACN,IAAIC,gBAAgB;IAEpB,MAAMC,OAAO,GAAGA,CAAA,KAAM;MAClBF,EAAE,GAAG,IAAIG,SAAS,CAACX,GAAG,CAAC;MAEvBQ,EAAE,CAACI,MAAM,GAAG,MAAM;QACdC,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAC;QAClCX,SAAS,CAACK,EAAE,CAAC;QACbD,mBAAmB,CAAC,WAAW,CAAC;MACpC,CAAC;MAEDC,EAAE,CAACO,SAAS,GAAIC,KAAK,IAAK;QACtB,IAAI;UACA,MAAMC,UAAU,GAAGC,IAAI,CAACC,KAAK,CAACH,KAAK,CAACI,IAAI,CAAC;UACzCf,WAAW,CAACgB,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAEJ,UAAU,CAAC,CAAC;QAC9C,CAAC,CAAC,OAAOK,GAAG,EAAE;UACVT,OAAO,CAACU,KAAK,CAAC,kCAAkC,EAAED,GAAG,CAAC;QAC1D;MACJ,CAAC;MAEDd,EAAE,CAACgB,OAAO,GAAG,MAAM;QACfX,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAC;QACrCX,SAAS,CAAC,IAAI,CAAC;QACfI,mBAAmB,CAAC,cAAc,CAAC;QACnCE,gBAAgB,GAAGgB,UAAU,CAAC,MAAM;UAChClB,mBAAmB,CAAC,cAAc,CAAC;UACnCG,OAAO,CAAC,CAAC;QACb,CAAC,EAAE,IAAI,CAAC;MACZ,CAAC;MAEDF,EAAE,CAACkB,OAAO,GAAIH,KAAK,IAAK;QACpBV,OAAO,CAACU,KAAK,CAAC,kBAAkB,EAAEA,KAAK,CAAC;QACxChB,mBAAmB,CAAC,OAAO,CAAC;MAChC,CAAC;IACL,CAAC;IAEDG,OAAO,CAAC,CAAC;IAET,OAAO,MAAM;MACT,IAAIF,EAAE,IAAIA,EAAE,CAACmB,UAAU,KAAKhB,SAAS,CAACiB,IAAI,EAAE;QACxCpB,EAAE,CAACqB,KAAK,CAAC,CAAC;MACd;MACA,IAAIpB,gBAAgB,EAAE;QAClBqB,YAAY,CAACrB,gBAAgB,CAAC;MAClC;IACJ,CAAC;EACL,CAAC,EAAE,CAACT,GAAG,CAAC,CAAC;EAET,MAAM+B,WAAW,GAAIC,OAAO,IAAK;IAC7B,IAAI9B,MAAM,IAAIA,MAAM,CAACyB,UAAU,KAAKhB,SAAS,CAACiB,IAAI,EAAE;MAChD1B,MAAM,CAAC+B,IAAI,CAACf,IAAI,CAACgB,SAAS,CAACF,OAAO,CAAC,CAAC;IACxC,CAAC,MAAM;MACHnB,OAAO,CAACU,KAAK,CAAC,4BAA4B,CAAC;IAC/C;EACJ,CAAC;EAED,OAAO;IACHrB,MAAM;IACNE,QAAQ;IACR2B,WAAW;IACXzB;EACJ,CAAC;AACL,CAAC;AAACL,EAAA,CArEIF,YAAY;AAuElB,eAAeA,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}