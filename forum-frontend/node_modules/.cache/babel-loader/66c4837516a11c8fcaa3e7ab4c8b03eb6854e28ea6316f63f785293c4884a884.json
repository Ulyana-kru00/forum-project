{"ast":null,"code":"var _jsxFileName = \"/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/components/Chat/Chat.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// src/components/Chat/Chat.jsx\nimport React, { useState, useEffect, useCallback } from 'react';\nimport '/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/components/MainLayout.css';\n\n// Утилита для логирования\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst logger = {\n  log: (message, data = {}) => {\n    if (process.env.NODE_ENV === 'development') {\n      console.log(`[Chat][${new Date().toISOString()}] ${message}`, data);\n    }\n  },\n  error: (message, error) => {\n    console.error(`[Chat][ERROR][${new Date().toISOString()}] ${message}`, error);\n  }\n};\nconst useChat = () => {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [socket, setSocket] = useState(null);\n  const [connectionStatus, setConnectionStatus] = useState('disconnected');\n  const [error, setError] = useState(null);\n  const connectWebSocket = useCallback(token => {\n    logger.log('Attempting WebSocket connection', {\n      token: token ? 'exists' : 'missing'\n    });\n    const ws = new WebSocket(`ws://localhost:8082/ws?token=${encodeURIComponent(token)}`);\n    ws.onopen = () => {\n      logger.log('WebSocket connection established');\n      setConnectionStatus('connected');\n      setError(null);\n    };\n    ws.onmessage = event => {\n      logger.log('New message received', {\n        event\n      });\n      try {\n        const message = JSON.parse(event.data);\n        logger.log('Message parsed successfully', {\n          message\n        });\n        setMessages(prev => [...prev, message]);\n      } catch (e) {\n        logger.error('Error parsing message', e);\n      }\n    };\n    ws.onclose = event => {\n      logger.log('WebSocket connection closed', {\n        event\n      });\n      setConnectionStatus('disconnected');\n      if (!event.wasClean) {\n        const errorMessage = 'Connection lost. Reconnecting...';\n        logger.log(errorMessage);\n        setError(errorMessage);\n        setTimeout(() => connectWebSocket(token), 3000);\n      }\n    };\n    ws.onerror = error => {\n      logger.error('WebSocket error occurred', error);\n      setError('WebSocket error: ' + error.message);\n      setConnectionStatus('error');\n    };\n    setSocket(ws);\n    return () => {\n      logger.log('Cleaning up WebSocket connection');\n      ws.close();\n    };\n  }, []);\n  const sendMessage = messageText => {\n    if (socket && socket.readyState === WebSocket.OPEN) {\n      logger.log('Sending message', {\n        messageText\n      });\n      const message = {\n        Text: messageText,\n        CreatedAt: new Date().toISOString()\n      };\n      socket.send(JSON.stringify(message));\n    } else {\n      logger.error('Attempt to send message when socket is not open', {\n        socketState: socket === null || socket === void 0 ? void 0 : socket.readyState\n      });\n    }\n  };\n  return {\n    messages,\n    sendMessage,\n    connectionStatus,\n    error,\n    connectWebSocket\n  };\n};\n_s(useChat, \"fCU3rdB/ofpWPmu7uDDAJNcFTXQ=\");\nconst Chat = () => {\n  _s2();\n  const [messageInput, setMessageInput] = useState('');\n  const [user, setUser] = useState(null);\n  const {\n    messages,\n    sendMessage,\n    connectionStatus,\n    error,\n    connectWebSocket\n  } = useChat();\n  useEffect(() => {\n    logger.log('Component mounted, checking authentication');\n    const token = localStorage.getItem('token');\n    const userId = localStorage.getItem('userId');\n    const username = localStorage.getItem('username');\n    if (token && userId && username) {\n      logger.log('User authenticated', {\n        userId,\n        username\n      });\n      setUser({\n        id: userId,\n        username\n      });\n      connectWebSocket(token);\n    } else {\n      logger.log('User not authenticated, redirect required');\n    }\n  }, [connectWebSocket]);\n  const handleSubmit = e => {\n    e.preventDefault();\n    logger.log('Message form submitted', {\n      messageInput\n    });\n    if (messageInput.trim() && user) {\n      try {\n        sendMessage(messageInput);\n        setMessageInput('');\n      } catch (e) {\n        logger.error('Failed to send message', e);\n      }\n    }\n  };\n  if (!user) {\n    logger.log('Rendering authentication warning');\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-container\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"auth-warning\",\n        children: \"Please login to access the chat\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }, this);\n  }\n  logger.log('Rendering chat interface', {\n    messageCount: messages.length,\n    connectionStatus\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Forum Chat\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `status ${connectionStatus}`,\n        children: connectionStatus.toUpperCase()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"messages\",\n      children: messages.map((msg, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `message ${msg.UserID === user.id ? 'own' : 'other'}`,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"message-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"username\",\n            children: msg.Username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 154,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"time\",\n            children: new Date(msg.CreatedAt).toLocaleTimeString()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"content\",\n          children: msg.Text\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 13\n        }, this)]\n      }, index, true, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"message-form\",\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        value: messageInput,\n        onChange: e => {\n          logger.log('Message input changed', {\n            value: e.target.value\n          });\n          setMessageInput(e.target.value);\n        },\n        placeholder: \"Type your message...\",\n        disabled: connectionStatus !== 'connected'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        disabled: connectionStatus !== 'connected' || !messageInput.trim(),\n        children: \"Send\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 137,\n    columnNumber: 5\n  }, this);\n};\n_s2(Chat, \"jejdEd6Hllb/ifYFZBWFpT/34eQ=\", false, function () {\n  return [useChat];\n});\n_c = Chat;\nexport default Chat;\n// import React, { useState, useEffect } from 'react';\n// import useWebSocket from '/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/hooks/useWebSocket.js';\n// import '/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/components/MainLayout.css';\n\n// const Chat = () => {\n//     const [messageInput, setMessageInput] = useState('');\n//     const [userData, setUserData] = useState(null);\n//     const token = localStorage.getItem('token');\n//     const wsUrl = `ws://localhost:8082/ws`;\n\n//     const {\n//         messages,\n//         sendMessage,\n//         connectionStatus,\n//         error\n//     } = useWebSocket(wsUrl, token);\n\n//     // Загрузка данных пользователя при монтировании\n//     useEffect(() => {\n//         const userId = localStorage.getItem('userId');\n//         const username = localStorage.getItem('username');\n//         if (userId && username) {\n//             setUserData({ id: userId, username });\n//         }\n//     }, []);\n\n//     // Обработка ошибок\n//     useEffect(() => {\n//         if (error) {\n//             console.error('Chat error:', error);\n//         }\n//     }, [error]);\n\n//     const handleSubmit = (e) => {\n//         e.preventDefault();\n//         if (messageInput.trim() && userData) {\n//             sendMessage({\n//                 Text: messageInput,\n//                 UserID: userData.id,\n//                 Username: userData.username,\n//                 CreatedAt: new Date().toISOString()\n//             });\n//             setMessageInput('');\n//         }\n//     };\n\n//     if (!userData) {\n//         return (\n//             <div className=\"chat-container\">\n//                 <div className=\"auth-warning\">\n//                     Please login to access the chat\n//                 </div>\n//             </div>\n//         );\n//     }\n\n//     return (\n//         <div className=\"chat-container\">\n//             <div className=\"chat-header\">\n//                 <h2>Global Chat</h2>\n//                 <div className={`connection-status ${connectionStatus}`}>\n//                     Status: {connectionStatus.toUpperCase()}\n//                 </div>\n//             </div>\n\n//             <div className=\"messages-list\">\n//                 {messages.map((message, index) => (\n//                     <div key={index} className={`message ${message.UserID === userData.id ? 'own-message' : ''}`}>\n//                         <div className=\"message-header\">\n//                             <span className=\"username\">{message.Username}</span>\n//                             <span className=\"timestamp\">\n//                                 {new Date(message.CreatedAt).toLocaleTimeString()}\n//                             </span>\n//                         </div>\n//                         <div className=\"message-content\">\n//                             {message.Text}\n//                         </div>\n//                     </div>\n//                 ))}\n//             </div>\n\n//             <form className=\"message-form\" onSubmit={handleSubmit}>\n//                 <input\n//                     type=\"text\"\n//                     value={messageInput}\n//                     onChange={(e) => setMessageInput(e.target.value)}\n//                     placeholder=\"Type your message...\"\n//                     disabled={connectionStatus !== 'connected'}\n//                     aria-label=\"Type your message\"\n//                 />\n//                 <button\n//                     type=\"submit\"\n//                     disabled={!messageInput.trim() || connectionStatus !== 'connected'}\n//                     className=\"send-button\"\n//                 >\n//                     {connectionStatus === 'connected' ? 'Send' : 'Connecting...'}\n//                 </button>\n//             </form>\n\n//             {error && (\n//                 <div className=\"error-message\">\n//                     Error: {error}\n//                 </div>\n//             )}\n//         </div>\n//     );\n// };\n\n// export default Chat;\n// import React, { useState } from 'react';\n// import useWebSocket from '/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/hooks/useWebSocket.js';\n// import '/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/components/MainLayout.css';\n\n// const Chat = () => {\n//     const [message, setMessage] = useState('');\n//     const userId = localStorage.getItem('userId');\n//     const token = localStorage.getItem('token'); // Ensure this is the JWT token\n//     const wsUrl = `ws://localhost:8082/ws`;\n\n//     const { \n//         messages, \n//         sendMessage, \n//         connectionStatus \n//     } = useWebSocket(wsUrl);\n\n//     if (!userId) {\n//         return <div>Please login to use chat</div>;\n//     }\n\n//     const handleSubmit = (e) => {\n//         e.preventDefault();\n//         if (message.trim()) {\n//             sendMessage({\n//                 content: message,\n//                 userId: userId,\n//                 timestamp: new Date().toISOString()\n//             });\n//             setMessage('');\n//         }\n//     };\n\n//     return (\n//         <div className=\"chat-container\">\n//             <div className=\"connection-status\">\n//                 Status: {connectionStatus}\n//             </div>\n//             <div className=\"messages\">\n//                 {messages.map((msg, index) => (\n//                     <div key={index} className=\"message\">\n//                         <span className=\"user\">{msg.userId}</span>\n//                         <span className=\"content\">{msg.content}</span>\n//                     </div>\n//                 ))}\n//             </div>\n//             <form onSubmit={handleSubmit}>\n//                 <input\n//                     type=\"text\"\n//                     value={message}\n//                     onChange={(e) => setMessage(e.target.value)}\n//                     placeholder=\"Type your message...\"\n//                     disabled={connectionStatus !== 'connected'}\n//                 />\n//                 <button \n//                     type=\"submit\"\n//                     disabled={connectionStatus !== 'connected'}\n//                 >\n//                     Send\n//                 </button>\n//             </form>\n//         </div>\n//     );\n// };\n// export default Chat;\n// // import React, { useState, useEffect, useCallback } from 'react';\n// // import axios from 'axios';\n// //  import useWebSocket from '/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/hooks/useWebSocket.js'; // путь поменяй если другой\n// //  import '/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/components/MainLayout.css'; // путь к стилям\n\n// // const Chat = () => {\n// //   const [message, setMessage] = useState('');\n// //   const [login, setLogin] = useState('');\n// //   const [password, setPassword] = useState('');\n// //   const [errorMessage, setErrorMessage] = useState('');\n// //   const [isLoggedIn, setIsLoggedIn] = useState(false);\n\n// //   const {\n// //     messages,\n// //     sendMessage,\n// //     connectionStatus,\n// //     connect,\n// //     disconnect,\n// //     error: wsError\n// //   } = useWebSocket('http://localhost:8082/ws', { manual: true });\n\n// //   // Проверка авторизации при монтировании\n// //   useEffect(() => {\n// //     const token = localStorage.getItem('token');\n// //     const userId = localStorage.getItem('userId');\n// //     const username = localStorage.getItem('username');\n\n// //     if (token && userId && username) {\n// //       setIsLoggedIn(true);\n// //     }\n// //   }, []);\n\n// //   // Управление подключением WebSocket\n// //   useEffect(() => {\n// //     if (isLoggedIn) {\n// //       connect();\n// //     }\n\n// //     return () => {\n// //       if (isLoggedIn) {\n// //         disconnect(true);\n// //       }\n// //     };\n// //   }, [isLoggedIn, connect, disconnect]);\n\n// //   // Механизм переподключения\n// //   useEffect(() => {\n// //     const reconnectInterval = setInterval(() => {\n// //       if (connectionStatus === 'disconnected' && isLoggedIn) {\n// //         connect();\n// //       }\n// //     }, 5000);\n\n// //     return () => clearInterval(reconnectInterval);\n// //   }, [connectionStatus, isLoggedIn, connect]);\n\n// //   const handleLogin = async (e) => {\n// //     e.preventDefault();\n// //     try {\n// //       const response = await axios.post('http://localhost:8080/login', {\n// //         login,\n// //         password,\n// //       });\n\n// //       const { token, userId, username } = response.data;\n\n// //       if (!token || !userId || !username) {\n// //         throw new Error('Invalid server response');\n// //       }\n\n// //       localStorage.setItem('token', token);\n// //       localStorage.setItem('userId', userId);\n// //       localStorage.setItem('username', username);\n\n// //       setIsLoggedIn(true);\n// //       setErrorMessage('');\n\n// //     } catch (error) {\n// //       console.error(\"Login error:\", error);\n// //       setErrorMessage(error.response?.data?.message || 'Login failed. Please try again.');\n// //       localStorage.clear();\n// //     }\n// //   };\n\n// //   const handleSendMessage = (e) => {\n// //     e.preventDefault();\n\n// //     const userId = localStorage.getItem('userId');\n// //     const username = localStorage.getItem('username');\n\n// //     if (!userId || !username) {\n// //       setErrorMessage('User session expired');\n// //       localStorage.clear();\n// //       setIsLoggedIn(false);\n// //       return;\n// //     }\n\n// //     if (!message.trim()) {\n// //       setErrorMessage('Cannot send empty message');\n// //       return;\n// //     }\n\n// //     sendMessage({\n// //       content: message.trim(),\n// //       userId: parseInt(userId, 10),\n// //       username,\n// //     });\n\n// //     setMessage('');\n// //     setErrorMessage('');\n// //   };\n\n// //   if (!isLoggedIn) {\n// //     return (\n// //       <div className=\"auth-container\">\n// //         <h2>Login to use Chat</h2>\n// //         <form onSubmit={handleLogin}>\n// //           <div className=\"form-group\">\n// //             <label>Login</label>\n// //             <input\n// //               type=\"text\"\n// //               value={login}\n// //               onChange={(e) => setLogin(e.target.value)}\n// //               required\n// //             />\n// //           </div>\n// //           <div className=\"form-group\">\n// //             <label>Password</label>\n// //             <input\n// //               type=\"password\"\n// //               value={password}\n// //               onChange={(e) => setPassword(e.target.value)}\n// //               required\n// //             />\n// //           </div>\n// //           <button type=\"submit\" className=\"btn-primary\">Login</button>\n// //           {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\n// //         </form>\n// //       </div>\n// //     );\n// //   }\n\n// //   return (\n// //     <div className=\"chat-container\">\n// //       <div className=\"connection-status\">\n// //         Connection Status: {connectionStatus}\n// //         {wsError && <span className=\"error-indicator\"> • Error</span>}\n// //       </div>\n\n// //       {wsError && <p className=\"error-message\">{wsError}</p>}\n\n// //       <div className=\"messages-panel\">\n// //         {messages.map((msg, index) => (\n// //           <div key={index} className=\"message\">\n// //             <span className=\"message-username\">{msg.username}:</span>\n// //             <span className=\"message-content\">{msg.content}</span>\n// //             <span className=\"message-timestamp\">\n// //               {new Date(msg.timestamp).toLocaleTimeString()}\n// //             </span>\n// //           </div>\n// //         ))}\n// //       </div>\n\n// //       <form onSubmit={handleSendMessage} className=\"message-form\">\n// //         <input\n// //           type=\"text\"\n// //           value={message}\n// //           onChange={(e) => setMessage(e.target.value)}\n// //           placeholder=\"Type your message...\"\n// //           className=\"message-input\"\n// //         />\n// //         <button \n// //           type=\"submit\" \n// //           className=\"send-button\"\n// //           disabled={connectionStatus !== 'connected'}\n// //         >\n// //           Send\n// //         </button>\n// //       </form>\n// //     </div>\n// //   );\n// // };\n\n// // export default Chat;\n// // import React, { useState, useEffect } from 'react';\n// // import axios from 'axios';\n// // import useWebSocket from '/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/hooks/useWebSocket.js'; // путь поменяй если другой\n// // import '/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/components/MainLayout.css'; // путь к стилям\n\n// // const Chat = () => {\n// //   const [message, setMessage] = useState('');\n// //   const [email, setEmail] = useState('');\n// //   const [password, setPassword] = useState('');\n// //   const [errorMessage, setErrorMessage] = useState('');\n// //   const [isLoggedIn, setIsLoggedIn] = useState(false);\n\n// //   const [userId, setUserId] = useState(null);\n// //   const [username, setUsername] = useState(null);\n\n// //   const {\n// //     messages,\n// //     sendMessage,\n// //     connectionStatus,\n// //     connect, // добавляем ручное подключение\n// //     disconnect\n// //   } = useWebSocket('ws://localhost:8082/ws', { manual: true }); // manual mode!\n\n// //   useEffect(() => {\n// //     const storedUserId = localStorage.getItem('userId');\n// //     const storedUsername = localStorage.getItem('username');\n// //     if (storedUserId && storedUsername) {\n// //       setUserId(storedUserId);\n// //       setUsername(storedUsername);\n// //       setIsLoggedIn(true);\n// //       connect(); // подключаем WebSocket только если есть данные\n// //     }\n// //   }, [connect]);\n\n// //   const handleLogin = async (e) => {\n// //     e.preventDefault();\n\n// //     try {\n// //       const response = await axios.post('http://localhost:8080/login', {\n// //         email,\n// //         password,\n// //       });\n\n// //       if (response.status === 200) {\n// //         const { userId, username, token } = response.data;\n\n// //         if (!userId || !username || username === 'undefined') {\n// //           console.warn('Invalid user session, cannot connect');\n// //           setErrorMessage('Login failed: server did not provide user info.');\n// //           return;\n// //         }\n\n// //         localStorage.setItem('userId', userId);\n// //         localStorage.setItem('username', username);\n// //         localStorage.setItem('token', token);\n\n// //         setUserId(userId);\n// //         setUsername(username);\n// //         setIsLoggedIn(true);\n\n// //         connect(); // подключаем WebSocket после логина\n\n// //       }\n// //     } catch (error) {\n// //       console.error(error);\n// //       setErrorMessage('Login failed. Please check your credentials.');\n// //     }\n// //   };\n\n// //   const handleSubmit = (e) => {\n// //     e.preventDefault();\n\n// //     if (!message.trim() || !username) {\n// //       console.warn('Cannot send empty message or missing username');\n// //       return;\n// //     }\n\n// //     sendMessage({\n// //       user_id:  userId,\n// //       username: username,\n// //       content: message.trim(),\n// //     });\n\n// //     setMessage('');\n// //   };\n\n// //   if (!isLoggedIn) {\n// //     return (\n// //       <div>\n// //         <h2>Login to use Chat</h2>\n// //         <form onSubmit={handleLogin}>\n// //           <div>\n// //             <label>Email</label>\n// //             <input\n// //               type=\"email\"\n// //               value={email}\n// //               onChange={(e) => setEmail(e.target.value)}\n// //               required\n// //             />\n// //           </div>\n// //           <div>\n// //             <label>Password</label>\n// //             <input\n// //               type=\"password\"\n// //               value={password}\n// //               onChange={(e) => setPassword(e.target.value)}\n// //               required\n// //             />\n// //           </div>\n// //           <button type=\"submit\">Login</button>\n// //         </form>\n\n// //         {errorMessage && <p style={{ color: 'red' }}>{errorMessage}</p>}\n// //       </div>\n// //     );\n// //   }\n\n// //   return (\n// //     <div className=\"chat-container\">\n// //       <div className=\"connection-status\">\n// //         Status: {connectionStatus}\n// //       </div>\n\n// //       <div className=\"messages\">\n// //         {messages.map((msg, index) => (\n// //           <div key={index} className=\"message\">\n// //             <span className=\"user\">{msg.username}:</span>  \n// //             <span className=\"content\">{msg.content}</span>\n// //           </div>\n// //         ))}\n// //       </div>\n\n// //       <form onSubmit={handleSubmit} className=\"chat-form\">\n// //         <input\n// //           type=\"text\"\n// //           value={message}\n// //           onChange={(e) => setMessage(e.target.value)}\n// //           placeholder=\"Type your message...\"\n// //           disabled={connectionStatus !== 'connected'}\n// //           className=\"chat-input\"\n// //         />\n// //         <button\n// //           type=\"submit\"\n// //           disabled={connectionStatus !== 'connected' || !message.trim()}\n// //           className=\"chat-send-button\"\n// //         >\n// //           Send\n// //         </button>\n// //       </form>\n// //     </div>\n// //   );\n// // };\n\n// // export default Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","jsxDEV","_jsxDEV","logger","log","message","data","process","env","NODE_ENV","console","Date","toISOString","error","useChat","_s","messages","setMessages","socket","setSocket","connectionStatus","setConnectionStatus","setError","connectWebSocket","token","ws","WebSocket","encodeURIComponent","onopen","onmessage","event","JSON","parse","prev","e","onclose","wasClean","errorMessage","setTimeout","onerror","close","sendMessage","messageText","readyState","OPEN","Text","CreatedAt","send","stringify","socketState","Chat","_s2","messageInput","setMessageInput","user","setUser","localStorage","getItem","userId","username","id","handleSubmit","preventDefault","trim","className","children","fileName","_jsxFileName","lineNumber","columnNumber","messageCount","length","toUpperCase","map","msg","index","UserID","Username","toLocaleTimeString","onSubmit","type","value","onChange","target","placeholder","disabled","_c","$RefreshReg$"],"sources":["/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/components/Chat/Chat.js"],"sourcesContent":["// src/components/Chat/Chat.jsx\nimport React, { useState, useEffect, useCallback } from 'react';\nimport '/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/components/MainLayout.css';\n\n// Утилита для логирования\nconst logger = {\n  log: (message, data = {}) => {\n    if (process.env.NODE_ENV === 'development') {\n      console.log(`[Chat][${new Date().toISOString()}] ${message}`, data);\n    }\n  },\n  error: (message, error) => {\n    console.error(`[Chat][ERROR][${new Date().toISOString()}] ${message}`, error);\n  }\n};\n\nconst useChat = () => {\n  const [messages, setMessages] = useState([]);\n  const [socket, setSocket] = useState(null);\n  const [connectionStatus, setConnectionStatus] = useState('disconnected');\n  const [error, setError] = useState(null);\n\n  const connectWebSocket = useCallback((token) => {\n    logger.log('Attempting WebSocket connection', { token: token ? 'exists' : 'missing' });\n    \n    const ws = new WebSocket(`ws://localhost:8082/ws?token=${encodeURIComponent(token)}`);\n\n    ws.onopen = () => {\n      logger.log('WebSocket connection established');\n      setConnectionStatus('connected');\n      setError(null);\n    };\n\n    ws.onmessage = (event) => {\n      logger.log('New message received', { event });\n      try {\n        const message = JSON.parse(event.data);\n        logger.log('Message parsed successfully', { message });\n        setMessages(prev => [...prev, message]);\n      } catch (e) {\n        logger.error('Error parsing message', e);\n      }\n    };\n\n    ws.onclose = (event) => {\n      logger.log('WebSocket connection closed', { event });\n      setConnectionStatus('disconnected');\n      if (!event.wasClean) {\n        const errorMessage = 'Connection lost. Reconnecting...';\n        logger.log(errorMessage);\n        setError(errorMessage);\n        setTimeout(() => connectWebSocket(token), 3000);\n      }\n    };\n\n    ws.onerror = (error) => {\n      logger.error('WebSocket error occurred', error);\n      setError('WebSocket error: ' + error.message);\n      setConnectionStatus('error');\n    };\n\n    setSocket(ws);\n    return () => {\n      logger.log('Cleaning up WebSocket connection');\n      ws.close();\n    };\n  }, []);\n\n  const sendMessage = (messageText) => {\n    if (socket && socket.readyState === WebSocket.OPEN) {\n      logger.log('Sending message', { messageText });\n      const message = {\n        Text: messageText,\n        CreatedAt: new Date().toISOString()\n      };\n      socket.send(JSON.stringify(message));\n    } else {\n      logger.error('Attempt to send message when socket is not open', {\n        socketState: socket?.readyState\n      });\n    }\n  };\n\n  return { messages, sendMessage, connectionStatus, error, connectWebSocket };\n};\n\nconst Chat = () => {\n  const [messageInput, setMessageInput] = useState('');\n  const [user, setUser] = useState(null);\n  const { messages, sendMessage, connectionStatus, error, connectWebSocket } = useChat();\n\n  useEffect(() => {\n    logger.log('Component mounted, checking authentication');\n    const token = localStorage.getItem('token');\n    const userId = localStorage.getItem('userId');\n    const username = localStorage.getItem('username');\n\n    if (token && userId && username) {\n      logger.log('User authenticated', { userId, username });\n      setUser({ id: userId, username });\n      connectWebSocket(token);\n    } else {\n      logger.log('User not authenticated, redirect required');\n    }\n  }, [connectWebSocket]);\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    logger.log('Message form submitted', { messageInput });\n    if (messageInput.trim() && user) {\n      try {\n        sendMessage(messageInput);\n        setMessageInput('');\n      } catch (e) {\n        logger.error('Failed to send message', e);\n      }\n    }\n  };\n\n  if (!user) {\n    logger.log('Rendering authentication warning');\n    return (\n      <div className=\"chat-container\">\n        <div className=\"auth-warning\">\n          Please login to access the chat\n        </div>\n      </div>\n    );\n  }\n\n  logger.log('Rendering chat interface', {\n    messageCount: messages.length,\n    connectionStatus\n  });\n\n  return (\n    <div className=\"chat-container\">\n      <div className=\"header\">\n        <h2>Forum Chat</h2>\n        <div className={`status ${connectionStatus}`}>\n          {connectionStatus.toUpperCase()}\n        </div>\n      </div>\n\n      {error && <div className=\"error\">{error}</div>}\n\n      <div className=\"messages\">\n        {messages.map((msg, index) => (\n          <div \n            key={index}\n            className={`message ${msg.UserID === user.id ? 'own' : 'other'}`}\n          >\n            <div className=\"message-header\">\n              <span className=\"username\">{msg.Username}</span>\n              <span className=\"time\">\n                {new Date(msg.CreatedAt).toLocaleTimeString()}\n              </span>\n            </div>\n            <div className=\"content\">{msg.Text}</div>\n          </div>\n        ))}\n      </div>\n\n      <form className=\"message-form\" onSubmit={handleSubmit}>\n        <input\n          type=\"text\"\n          value={messageInput}\n          onChange={(e) => {\n            logger.log('Message input changed', { value: e.target.value });\n            setMessageInput(e.target.value);\n          }}\n          placeholder=\"Type your message...\"\n          disabled={connectionStatus !== 'connected'}\n        />\n        <button \n          type=\"submit\"\n          disabled={connectionStatus !== 'connected' || !messageInput.trim()}\n        >\n          Send\n        </button>\n      </form>\n    </div>\n  );\n};\n\nexport default Chat;\n// import React, { useState, useEffect } from 'react';\n// import useWebSocket from '/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/hooks/useWebSocket.js';\n// import '/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/components/MainLayout.css';\n\n// const Chat = () => {\n//     const [messageInput, setMessageInput] = useState('');\n//     const [userData, setUserData] = useState(null);\n//     const token = localStorage.getItem('token');\n//     const wsUrl = `ws://localhost:8082/ws`;\n\n//     const {\n//         messages,\n//         sendMessage,\n//         connectionStatus,\n//         error\n//     } = useWebSocket(wsUrl, token);\n\n//     // Загрузка данных пользователя при монтировании\n//     useEffect(() => {\n//         const userId = localStorage.getItem('userId');\n//         const username = localStorage.getItem('username');\n//         if (userId && username) {\n//             setUserData({ id: userId, username });\n//         }\n//     }, []);\n\n//     // Обработка ошибок\n//     useEffect(() => {\n//         if (error) {\n//             console.error('Chat error:', error);\n//         }\n//     }, [error]);\n\n//     const handleSubmit = (e) => {\n//         e.preventDefault();\n//         if (messageInput.trim() && userData) {\n//             sendMessage({\n//                 Text: messageInput,\n//                 UserID: userData.id,\n//                 Username: userData.username,\n//                 CreatedAt: new Date().toISOString()\n//             });\n//             setMessageInput('');\n//         }\n//     };\n\n//     if (!userData) {\n//         return (\n//             <div className=\"chat-container\">\n//                 <div className=\"auth-warning\">\n//                     Please login to access the chat\n//                 </div>\n//             </div>\n//         );\n//     }\n\n//     return (\n//         <div className=\"chat-container\">\n//             <div className=\"chat-header\">\n//                 <h2>Global Chat</h2>\n//                 <div className={`connection-status ${connectionStatus}`}>\n//                     Status: {connectionStatus.toUpperCase()}\n//                 </div>\n//             </div>\n\n//             <div className=\"messages-list\">\n//                 {messages.map((message, index) => (\n//                     <div key={index} className={`message ${message.UserID === userData.id ? 'own-message' : ''}`}>\n//                         <div className=\"message-header\">\n//                             <span className=\"username\">{message.Username}</span>\n//                             <span className=\"timestamp\">\n//                                 {new Date(message.CreatedAt).toLocaleTimeString()}\n//                             </span>\n//                         </div>\n//                         <div className=\"message-content\">\n//                             {message.Text}\n//                         </div>\n//                     </div>\n//                 ))}\n//             </div>\n\n//             <form className=\"message-form\" onSubmit={handleSubmit}>\n//                 <input\n//                     type=\"text\"\n//                     value={messageInput}\n//                     onChange={(e) => setMessageInput(e.target.value)}\n//                     placeholder=\"Type your message...\"\n//                     disabled={connectionStatus !== 'connected'}\n//                     aria-label=\"Type your message\"\n//                 />\n//                 <button\n//                     type=\"submit\"\n//                     disabled={!messageInput.trim() || connectionStatus !== 'connected'}\n//                     className=\"send-button\"\n//                 >\n//                     {connectionStatus === 'connected' ? 'Send' : 'Connecting...'}\n//                 </button>\n//             </form>\n\n//             {error && (\n//                 <div className=\"error-message\">\n//                     Error: {error}\n//                 </div>\n//             )}\n//         </div>\n//     );\n// };\n\n// export default Chat;\n// import React, { useState } from 'react';\n// import useWebSocket from '/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/hooks/useWebSocket.js';\n// import '/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/components/MainLayout.css';\n\n// const Chat = () => {\n//     const [message, setMessage] = useState('');\n//     const userId = localStorage.getItem('userId');\n//     const token = localStorage.getItem('token'); // Ensure this is the JWT token\n//     const wsUrl = `ws://localhost:8082/ws`;\n    \n//     const { \n//         messages, \n//         sendMessage, \n//         connectionStatus \n//     } = useWebSocket(wsUrl);\n\n//     if (!userId) {\n//         return <div>Please login to use chat</div>;\n//     }\n\n//     const handleSubmit = (e) => {\n//         e.preventDefault();\n//         if (message.trim()) {\n//             sendMessage({\n//                 content: message,\n//                 userId: userId,\n//                 timestamp: new Date().toISOString()\n//             });\n//             setMessage('');\n//         }\n//     };\n\n//     return (\n//         <div className=\"chat-container\">\n//             <div className=\"connection-status\">\n//                 Status: {connectionStatus}\n//             </div>\n//             <div className=\"messages\">\n//                 {messages.map((msg, index) => (\n//                     <div key={index} className=\"message\">\n//                         <span className=\"user\">{msg.userId}</span>\n//                         <span className=\"content\">{msg.content}</span>\n//                     </div>\n//                 ))}\n//             </div>\n//             <form onSubmit={handleSubmit}>\n//                 <input\n//                     type=\"text\"\n//                     value={message}\n//                     onChange={(e) => setMessage(e.target.value)}\n//                     placeholder=\"Type your message...\"\n//                     disabled={connectionStatus !== 'connected'}\n//                 />\n//                 <button \n//                     type=\"submit\"\n//                     disabled={connectionStatus !== 'connected'}\n//                 >\n//                     Send\n//                 </button>\n//             </form>\n//         </div>\n//     );\n// };\n// export default Chat;\n// // import React, { useState, useEffect, useCallback } from 'react';\n// // import axios from 'axios';\n// //  import useWebSocket from '/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/hooks/useWebSocket.js'; // путь поменяй если другой\n// //  import '/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/components/MainLayout.css'; // путь к стилям\n\n// // const Chat = () => {\n// //   const [message, setMessage] = useState('');\n// //   const [login, setLogin] = useState('');\n// //   const [password, setPassword] = useState('');\n// //   const [errorMessage, setErrorMessage] = useState('');\n// //   const [isLoggedIn, setIsLoggedIn] = useState(false);\n  \n// //   const {\n// //     messages,\n// //     sendMessage,\n// //     connectionStatus,\n// //     connect,\n// //     disconnect,\n// //     error: wsError\n// //   } = useWebSocket('http://localhost:8082/ws', { manual: true });\n\n// //   // Проверка авторизации при монтировании\n// //   useEffect(() => {\n// //     const token = localStorage.getItem('token');\n// //     const userId = localStorage.getItem('userId');\n// //     const username = localStorage.getItem('username');\n    \n// //     if (token && userId && username) {\n// //       setIsLoggedIn(true);\n// //     }\n// //   }, []);\n\n// //   // Управление подключением WebSocket\n// //   useEffect(() => {\n// //     if (isLoggedIn) {\n// //       connect();\n// //     }\n    \n// //     return () => {\n// //       if (isLoggedIn) {\n// //         disconnect(true);\n// //       }\n// //     };\n// //   }, [isLoggedIn, connect, disconnect]);\n\n// //   // Механизм переподключения\n// //   useEffect(() => {\n// //     const reconnectInterval = setInterval(() => {\n// //       if (connectionStatus === 'disconnected' && isLoggedIn) {\n// //         connect();\n// //       }\n// //     }, 5000);\n\n// //     return () => clearInterval(reconnectInterval);\n// //   }, [connectionStatus, isLoggedIn, connect]);\n\n// //   const handleLogin = async (e) => {\n// //     e.preventDefault();\n// //     try {\n// //       const response = await axios.post('http://localhost:8080/login', {\n// //         login,\n// //         password,\n// //       });\n\n// //       const { token, userId, username } = response.data;\n      \n// //       if (!token || !userId || !username) {\n// //         throw new Error('Invalid server response');\n// //       }\n\n// //       localStorage.setItem('token', token);\n// //       localStorage.setItem('userId', userId);\n// //       localStorage.setItem('username', username);\n      \n// //       setIsLoggedIn(true);\n// //       setErrorMessage('');\n\n// //     } catch (error) {\n// //       console.error(\"Login error:\", error);\n// //       setErrorMessage(error.response?.data?.message || 'Login failed. Please try again.');\n// //       localStorage.clear();\n// //     }\n// //   };\n\n// //   const handleSendMessage = (e) => {\n// //     e.preventDefault();\n    \n// //     const userId = localStorage.getItem('userId');\n// //     const username = localStorage.getItem('username');\n    \n// //     if (!userId || !username) {\n// //       setErrorMessage('User session expired');\n// //       localStorage.clear();\n// //       setIsLoggedIn(false);\n// //       return;\n// //     }\n\n// //     if (!message.trim()) {\n// //       setErrorMessage('Cannot send empty message');\n// //       return;\n// //     }\n\n// //     sendMessage({\n// //       content: message.trim(),\n// //       userId: parseInt(userId, 10),\n// //       username,\n// //     });\n\n// //     setMessage('');\n// //     setErrorMessage('');\n// //   };\n\n// //   if (!isLoggedIn) {\n// //     return (\n// //       <div className=\"auth-container\">\n// //         <h2>Login to use Chat</h2>\n// //         <form onSubmit={handleLogin}>\n// //           <div className=\"form-group\">\n// //             <label>Login</label>\n// //             <input\n// //               type=\"text\"\n// //               value={login}\n// //               onChange={(e) => setLogin(e.target.value)}\n// //               required\n// //             />\n// //           </div>\n// //           <div className=\"form-group\">\n// //             <label>Password</label>\n// //             <input\n// //               type=\"password\"\n// //               value={password}\n// //               onChange={(e) => setPassword(e.target.value)}\n// //               required\n// //             />\n// //           </div>\n// //           <button type=\"submit\" className=\"btn-primary\">Login</button>\n// //           {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\n// //         </form>\n// //       </div>\n// //     );\n// //   }\n\n// //   return (\n// //     <div className=\"chat-container\">\n// //       <div className=\"connection-status\">\n// //         Connection Status: {connectionStatus}\n// //         {wsError && <span className=\"error-indicator\"> • Error</span>}\n// //       </div>\n      \n// //       {wsError && <p className=\"error-message\">{wsError}</p>}\n\n// //       <div className=\"messages-panel\">\n// //         {messages.map((msg, index) => (\n// //           <div key={index} className=\"message\">\n// //             <span className=\"message-username\">{msg.username}:</span>\n// //             <span className=\"message-content\">{msg.content}</span>\n// //             <span className=\"message-timestamp\">\n// //               {new Date(msg.timestamp).toLocaleTimeString()}\n// //             </span>\n// //           </div>\n// //         ))}\n// //       </div>\n\n// //       <form onSubmit={handleSendMessage} className=\"message-form\">\n// //         <input\n// //           type=\"text\"\n// //           value={message}\n// //           onChange={(e) => setMessage(e.target.value)}\n// //           placeholder=\"Type your message...\"\n// //           className=\"message-input\"\n// //         />\n// //         <button \n// //           type=\"submit\" \n// //           className=\"send-button\"\n// //           disabled={connectionStatus !== 'connected'}\n// //         >\n// //           Send\n// //         </button>\n// //       </form>\n// //     </div>\n// //   );\n// // };\n\n// // export default Chat;\n// // import React, { useState, useEffect } from 'react';\n// // import axios from 'axios';\n// // import useWebSocket from '/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/hooks/useWebSocket.js'; // путь поменяй если другой\n// // import '/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/components/MainLayout.css'; // путь к стилям\n\n// // const Chat = () => {\n// //   const [message, setMessage] = useState('');\n// //   const [email, setEmail] = useState('');\n// //   const [password, setPassword] = useState('');\n// //   const [errorMessage, setErrorMessage] = useState('');\n// //   const [isLoggedIn, setIsLoggedIn] = useState(false);\n\n// //   const [userId, setUserId] = useState(null);\n// //   const [username, setUsername] = useState(null);\n\n// //   const {\n// //     messages,\n// //     sendMessage,\n// //     connectionStatus,\n// //     connect, // добавляем ручное подключение\n// //     disconnect\n// //   } = useWebSocket('ws://localhost:8082/ws', { manual: true }); // manual mode!\n\n// //   useEffect(() => {\n// //     const storedUserId = localStorage.getItem('userId');\n// //     const storedUsername = localStorage.getItem('username');\n// //     if (storedUserId && storedUsername) {\n// //       setUserId(storedUserId);\n// //       setUsername(storedUsername);\n// //       setIsLoggedIn(true);\n// //       connect(); // подключаем WebSocket только если есть данные\n// //     }\n// //   }, [connect]);\n\n// //   const handleLogin = async (e) => {\n// //     e.preventDefault();\n\n// //     try {\n// //       const response = await axios.post('http://localhost:8080/login', {\n// //         email,\n// //         password,\n// //       });\n\n// //       if (response.status === 200) {\n// //         const { userId, username, token } = response.data;\n\n// //         if (!userId || !username || username === 'undefined') {\n// //           console.warn('Invalid user session, cannot connect');\n// //           setErrorMessage('Login failed: server did not provide user info.');\n// //           return;\n// //         }\n\n// //         localStorage.setItem('userId', userId);\n// //         localStorage.setItem('username', username);\n// //         localStorage.setItem('token', token);\n\n// //         setUserId(userId);\n// //         setUsername(username);\n// //         setIsLoggedIn(true);\n\n// //         connect(); // подключаем WebSocket после логина\n\n// //       }\n// //     } catch (error) {\n// //       console.error(error);\n// //       setErrorMessage('Login failed. Please check your credentials.');\n// //     }\n// //   };\n\n// //   const handleSubmit = (e) => {\n// //     e.preventDefault();\n\n// //     if (!message.trim() || !username) {\n// //       console.warn('Cannot send empty message or missing username');\n// //       return;\n// //     }\n\n// //     sendMessage({\n// //       user_id:  userId,\n// //       username: username,\n// //       content: message.trim(),\n// //     });\n\n// //     setMessage('');\n// //   };\n\n// //   if (!isLoggedIn) {\n// //     return (\n// //       <div>\n// //         <h2>Login to use Chat</h2>\n// //         <form onSubmit={handleLogin}>\n// //           <div>\n// //             <label>Email</label>\n// //             <input\n// //               type=\"email\"\n// //               value={email}\n// //               onChange={(e) => setEmail(e.target.value)}\n// //               required\n// //             />\n// //           </div>\n// //           <div>\n// //             <label>Password</label>\n// //             <input\n// //               type=\"password\"\n// //               value={password}\n// //               onChange={(e) => setPassword(e.target.value)}\n// //               required\n// //             />\n// //           </div>\n// //           <button type=\"submit\">Login</button>\n// //         </form>\n\n// //         {errorMessage && <p style={{ color: 'red' }}>{errorMessage}</p>}\n// //       </div>\n// //     );\n// //   }\n\n// //   return (\n// //     <div className=\"chat-container\">\n// //       <div className=\"connection-status\">\n// //         Status: {connectionStatus}\n// //       </div>\n\n// //       <div className=\"messages\">\n// //         {messages.map((msg, index) => (\n// //           <div key={index} className=\"message\">\n// //             <span className=\"user\">{msg.username}:</span>  \n// //             <span className=\"content\">{msg.content}</span>\n// //           </div>\n// //         ))}\n// //       </div>\n\n// //       <form onSubmit={handleSubmit} className=\"chat-form\">\n// //         <input\n// //           type=\"text\"\n// //           value={message}\n// //           onChange={(e) => setMessage(e.target.value)}\n// //           placeholder=\"Type your message...\"\n// //           disabled={connectionStatus !== 'connected'}\n// //           className=\"chat-input\"\n// //         />\n// //         <button\n// //           type=\"submit\"\n// //           disabled={connectionStatus !== 'connected' || !message.trim()}\n// //           className=\"chat-send-button\"\n// //         >\n// //           Send\n// //         </button>\n// //       </form>\n// //     </div>\n// //   );\n// // };\n\n// // export default Chat;\n"],"mappings":"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CA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AAAA,IAAAoC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}