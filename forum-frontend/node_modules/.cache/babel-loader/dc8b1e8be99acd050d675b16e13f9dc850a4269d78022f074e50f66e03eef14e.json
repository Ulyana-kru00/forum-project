{"ast":null,"code":"var _s = $RefreshSig$();\n// useWebSocket.js\nimport { useState, useEffect } from 'react';\nconst useWebSocket = url => {\n  _s();\n  const [socket, setSocket] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [connectionStatus, setConnectionStatus] = useState('disconnected');\n  useEffect(() => {\n    const ws = new WebSocket(url);\n    ws.onopen = () => {\n      console.log('WebSocket connected');\n      setSocket(ws);\n      setConnectionStatus('connected');\n    };\n    ws.onmessage = event => {\n      try {\n        const newMessage = JSON.parse(event.data);\n        setMessages(prev => [...prev, newMessage]);\n      } catch (err) {\n        console.error('Error parsing WebSocket message:', err);\n      }\n    };\n    ws.onclose = () => {\n      console.log('WebSocket disconnected');\n      setSocket(null);\n      setConnectionStatus('disconnected');\n      // Attempt to reconnect after 5 seconds\n      setTimeout(() => {\n        setConnectionStatus('reconnecting');\n      }, 5000);\n    };\n    ws.onerror = error => {\n      console.error('WebSocket error:', error);\n      setConnectionStatus('error');\n    };\n    return () => {\n      if (ws && ws.readyState === WebSocket.OPEN) {\n        ws.close();\n      }\n    };\n  }, [url]);\n  const sendMessage = message => {\n    if (socket && socket.readyState === WebSocket.OPEN) {\n      socket.send(JSON.stringify(message));\n    } else {\n      console.error('WebSocket is not connected');\n      // Optionally queue messages when disconnected\n    }\n  };\n  return {\n    socket,\n    messages,\n    sendMessage,\n    connectionStatus\n  };\n};\n_s(useWebSocket, \"IhKKRB2Nnw9qvmZutzwECZ0X7o4=\");\nexport default useWebSocket; // Добавьте эту строку","map":{"version":3,"names":["useState","useEffect","useWebSocket","url","_s","socket","setSocket","messages","setMessages","connectionStatus","setConnectionStatus","ws","WebSocket","onopen","console","log","onmessage","event","newMessage","JSON","parse","data","prev","err","error","onclose","setTimeout","onerror","readyState","OPEN","close","sendMessage","message","send","stringify"],"sources":["/Users/darinautalieva/Desktop/GOProject/forum-frontend/src/hooks/useWebSocket.js"],"sourcesContent":["// useWebSocket.js\nimport { useState, useEffect } from 'react';\nconst useWebSocket = (url) => {\n    const [socket, setSocket] = useState(null);\n    const [messages, setMessages] = useState([]);\n    const [connectionStatus, setConnectionStatus] = useState('disconnected');\n\n    useEffect(() => {\n        const ws = new WebSocket(url);\n        \n        ws.onopen = () => {\n            console.log('WebSocket connected');\n            setSocket(ws);\n            setConnectionStatus('connected');\n        };\n\n        ws.onmessage = (event) => {\n            try {\n                const newMessage = JSON.parse(event.data);\n                setMessages(prev => [...prev, newMessage]);\n            } catch (err) {\n                console.error('Error parsing WebSocket message:', err);\n            }\n        };\n\n        ws.onclose = () => {\n            console.log('WebSocket disconnected');\n            setSocket(null);\n            setConnectionStatus('disconnected');\n            // Attempt to reconnect after 5 seconds\n            setTimeout(() => {\n                setConnectionStatus('reconnecting');\n            }, 5000);\n        };\n\n        ws.onerror = (error) => {\n            console.error('WebSocket error:', error);\n            setConnectionStatus('error');\n        };\n\n        return () => {\n            if (ws && ws.readyState === WebSocket.OPEN) {\n                ws.close();\n            }\n        };\n    }, [url]);\n\n    const sendMessage = (message) => {\n        if (socket && socket.readyState === WebSocket.OPEN) {\n            socket.send(JSON.stringify(message));\n        } else {\n            console.error('WebSocket is not connected');\n            // Optionally queue messages when disconnected\n        }\n    };\n\n    return { \n        socket, \n        messages, \n        sendMessage, \n        connectionStatus \n    };\n};\n\nexport default useWebSocket; // Добавьте эту строку"],"mappings":";AAAA;AACA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAC3C,MAAMC,YAAY,GAAIC,GAAG,IAAK;EAAAC,EAAA;EAC1B,MAAM,CAACC,MAAM,EAAEC,SAAS,CAAC,GAAGN,QAAQ,CAAC,IAAI,CAAC;EAC1C,MAAM,CAACO,QAAQ,EAAEC,WAAW,CAAC,GAAGR,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACS,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGV,QAAQ,CAAC,cAAc,CAAC;EAExEC,SAAS,CAAC,MAAM;IACZ,MAAMU,EAAE,GAAG,IAAIC,SAAS,CAACT,GAAG,CAAC;IAE7BQ,EAAE,CAACE,MAAM,GAAG,MAAM;MACdC,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAC;MAClCT,SAAS,CAACK,EAAE,CAAC;MACbD,mBAAmB,CAAC,WAAW,CAAC;IACpC,CAAC;IAEDC,EAAE,CAACK,SAAS,GAAIC,KAAK,IAAK;MACtB,IAAI;QACA,MAAMC,UAAU,GAAGC,IAAI,CAACC,KAAK,CAACH,KAAK,CAACI,IAAI,CAAC;QACzCb,WAAW,CAACc,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAEJ,UAAU,CAAC,CAAC;MAC9C,CAAC,CAAC,OAAOK,GAAG,EAAE;QACVT,OAAO,CAACU,KAAK,CAAC,kCAAkC,EAAED,GAAG,CAAC;MAC1D;IACJ,CAAC;IAEDZ,EAAE,CAACc,OAAO,GAAG,MAAM;MACfX,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAC;MACrCT,SAAS,CAAC,IAAI,CAAC;MACfI,mBAAmB,CAAC,cAAc,CAAC;MACnC;MACAgB,UAAU,CAAC,MAAM;QACbhB,mBAAmB,CAAC,cAAc,CAAC;MACvC,CAAC,EAAE,IAAI,CAAC;IACZ,CAAC;IAEDC,EAAE,CAACgB,OAAO,GAAIH,KAAK,IAAK;MACpBV,OAAO,CAACU,KAAK,CAAC,kBAAkB,EAAEA,KAAK,CAAC;MACxCd,mBAAmB,CAAC,OAAO,CAAC;IAChC,CAAC;IAED,OAAO,MAAM;MACT,IAAIC,EAAE,IAAIA,EAAE,CAACiB,UAAU,KAAKhB,SAAS,CAACiB,IAAI,EAAE;QACxClB,EAAE,CAACmB,KAAK,CAAC,CAAC;MACd;IACJ,CAAC;EACL,CAAC,EAAE,CAAC3B,GAAG,CAAC,CAAC;EAET,MAAM4B,WAAW,GAAIC,OAAO,IAAK;IAC7B,IAAI3B,MAAM,IAAIA,MAAM,CAACuB,UAAU,KAAKhB,SAAS,CAACiB,IAAI,EAAE;MAChDxB,MAAM,CAAC4B,IAAI,CAACd,IAAI,CAACe,SAAS,CAACF,OAAO,CAAC,CAAC;IACxC,CAAC,MAAM;MACHlB,OAAO,CAACU,KAAK,CAAC,4BAA4B,CAAC;MAC3C;IACJ;EACJ,CAAC;EAED,OAAO;IACHnB,MAAM;IACNE,QAAQ;IACRwB,WAAW;IACXtB;EACJ,CAAC;AACL,CAAC;AAACL,EAAA,CA5DIF,YAAY;AA8DlB,eAAeA,YAAY,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}